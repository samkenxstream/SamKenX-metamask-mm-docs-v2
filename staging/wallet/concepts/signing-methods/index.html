<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-concepts/signing-methods">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Signing methods | MetaMask Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://metamask.github.io/mm-docs-v2/staging/wallet/concepts/signing-methods"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Signing methods | MetaMask Docs"><meta data-rh="true" name="description" content="There are currently six methods used to sign data in MetaMask:"><meta data-rh="true" property="og:description" content="There are currently six methods used to sign data in MetaMask:"><link data-rh="true" rel="icon" href="/mm-docs-v2/staging/img/metamask-fox.svg"><link data-rh="true" rel="canonical" href="https://metamask.github.io/mm-docs-v2/staging/wallet/concepts/signing-methods"><link data-rh="true" rel="alternate" href="https://metamask.github.io/mm-docs-v2/staging/wallet/concepts/signing-methods" hreflang="en"><link data-rh="true" rel="alternate" href="https://metamask.github.io/mm-docs-v2/staging/wallet/concepts/signing-methods" hreflang="x-default"><link rel="stylesheet" href="/mm-docs-v2/staging/assets/css/styles.27ddd041.css">
<link rel="preload" href="/mm-docs-v2/staging/assets/js/runtime~main.27521df3.js" as="script">
<link rel="preload" href="/mm-docs-v2/staging/assets/js/main.6ed78e4d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/mm-docs-v2/staging/"><div class="navbar__logo"><img src="/mm-docs-v2/staging/img/metamask-fox.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/mm-docs-v2/staging/img/metamask-fox.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">MetaMask docs</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/mm-docs-v2/staging/wallet/">Wallet</a><a class="navbar__item navbar__link" href="/mm-docs-v2/staging/snaps/">Snaps</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/mm-docs-v2/staging/"><img src="/mm-docs-v2/staging/img/metamask-fox.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/mm-docs-v2/staging/img/metamask-fox.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"><b>MetaMask docs</b></a><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mm-docs-v2/staging/wallet/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/mm-docs-v2/staging/wallet/category/get-started">Get started</a><button aria-label="Toggle the collapsible sidebar category &#x27;Get started&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mm-docs-v2/staging/wallet/get-started/set-up-dev-environment">Set up your development environment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mm-docs-v2/staging/wallet/get-started/run-development-network">Run a development network</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mm-docs-v2/staging/wallet/get-started/detect-metamask">Detect MetaMask</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mm-docs-v2/staging/wallet/get-started/detect-network">Detect a user&#x27;s network</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mm-docs-v2/staging/wallet/get-started/access-accounts">Access a user&#x27;s accounts</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/mm-docs-v2/staging/wallet/category/how-to">How to</a><button aria-label="Toggle the collapsible sidebar category &#x27;How to&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/mm-docs-v2/staging/wallet/category/concepts">Concepts</a><button aria-label="Toggle the collapsible sidebar category &#x27;Concepts&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mm-docs-v2/staging/wallet/concepts/sdk-connections">MetaMask SDK connections</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/mm-docs-v2/staging/wallet/concepts/signing-methods">Signing methods</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mm-docs-v2/staging/wallet/concepts/onboarding-library">Onboarding library</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mm-docs-v2/staging/wallet/concepts/convenience-libraries">Convenience libraries</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/mm-docs-v2/staging/wallet/category/tutorials">Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/mm-docs-v2/staging/wallet/category/reference">Reference</a><button aria-label="Toggle the collapsible sidebar category &#x27;Reference&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Signing methods</h1><p>There are currently six methods used to <a href="/mm-docs-v2/staging/wallet/how-to/sign-data">sign data</a> in MetaMask:</p><ul><li><code>eth_sign</code></li><li><code>personal_sign</code></li><li><code>signTypedData</code> (currently identical to <code>signTypedData_v1</code>)</li><li><code>signTypedData_v1</code></li><li><code>signTypedData_v3</code></li><li><code>signTypedData_v4</code></li></ul><p>You can see the <a href="https://github.com/MetaMask/eth-sig-util" target="_blank" rel="noopener noreferrer">JavaScript implementations of these methods</a>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="history">History<a class="hash-link" href="#history" title="Direct link to heading">​</a></h2><p>When MetaMask first started, the Provider API wasn&#x27;t designed to be exposed to untrusted websites,
and so some considerations weren&#x27;t taken as seriously as they were later.</p><p>In particular, the method <code>eth_sign</code> is an open-ended signing method that allows signing an
arbitrary hash, which means it can be used to sign transactions, or any other data, making it a
dangerous phishing risk.</p><p>For this reason, we make this method show the most frightening possible message to the user, and
generally discourage using this method in production.
However, some applications (usually admin panels internal to teams) use this method for the sake of
its ease of use, and so we have continued to support it for the sake of not breaking the workflows
of active projects.</p><p>Eventually, the <code>personal_sign</code> <a href="https://github.com/ethereum/go-ethereum/pull/2940" target="_blank" rel="noopener noreferrer">spec</a> was
proposed, which added a prefix to the data so it couldn&#x27;t impersonate transactions.
We also made this method able to display human-readable text when UTF-8 encoded, making it a popular
choice for site logins.</p><p>However, the text-prefix made those signatures expensive to verify on-chain, so with the help of the
<a href="https://0x.org/" target="_blank" rel="noopener noreferrer">0xProtocol</a> team and <a href="https://spankchain.com/" target="_blank" rel="noopener noreferrer">SpankChain</a>, the
<a href="https://eips.ethereum.org/EIPS/eip-712" target="_blank" rel="noopener noreferrer">EIP-712</a> spec was written.</p><p>The strange part of EIP-712, and this decentralized standards ecosystem, is that the proposal
changed several times while retaining the same EIP.
This means what we initially implemented as <code>signTypedData</code> was the earliest proposed version, while
other groups implemented later versions under the same method name.</p><p>To avoid compatibility issues between clients, we recommend using the hard-versioned method names
<code>signTypedData_v1</code> and <code>signTypedData_v3</code>.
The missing <code>v2</code> represents an intermediary design that was implemented by the Cipher browser, so
that we have room to implement it if there is ever enough developer demand for it.</p><p>In the future, it may help to have method names include a hash of their exact proposal, since in a
decentralized ecosystem, there is no absolute source of truth of what a given name should map to.
Instead, we are forced to invent new patterns of collaboration, where we can drive forward and
innovate, while simultaneously avoiding creating a brittle ecosystem by changing our meanings out
from under the words.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="signtypeddata_v1"><code>signTypedData_v1</code><a class="hash-link" href="#signtypeddata_v1" title="Direct link to heading">​</a></h3><p>This early version of the spec lacked some later security improvements, and should generally be
neglected in favor of <code>signTypedData_v3</code>.</p><p>Also known as <code>signTypedData</code>, originally premiered October 2017 in
<a href="https://medium.com/metamask/scaling-web3-with-signtypeddata-91d6efc8b290" target="_blank" rel="noopener noreferrer">this blog post</a>, this
method was the original state-channel-centric signing method.</p><p>The <code>signTypedData</code> family has a few major design considerations:</p><ul><li>Cheap to verify on chain</li><li>Still somewhat human-readable</li><li>Hard to phish signatures</li></ul><p>If on-chain verifiability cost is a high priority for you, you might want to consider it.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="signtypeddata_v3"><code>signTypedData_v3</code><a class="hash-link" href="#signtypeddata_v3" title="Direct link to heading">​</a></h3><p>The method <code>signTypedData_v3</code> is a highly used version of the
<a href="https://eips.ethereum.org/EIPS/eip-712" target="_blank" rel="noopener noreferrer">EIP-712 spec</a>.</p><p>You can read the
<a href="https://medium.com/metamask/eip712-is-coming-what-to-expect-and-how-to-use-it-bb92fd1a7a26" target="_blank" rel="noopener noreferrer">introductory blog post to this method</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="signtypeddata_v4"><code>signTypedData_v4</code><a class="hash-link" href="#signtypeddata_v4" title="Direct link to heading">​</a></h3><p>The method <code>signTypedData_v4</code> currently represents the latest version of the
<a href="https://eips.ethereum.org/EIPS/eip-712" target="_blank" rel="noopener noreferrer">EIP-712 spec</a>, with added support for arrays and with a
breaking fix for the way structs are encoded.</p><p>This doesn&#x27;t mean it&#x27;s perfect, and doesn&#x27;t mean we won&#x27;t eventually have a <code>v5</code>, but we do intend
to protect this namespace and keep it compatible going forwards.</p><p>You can read the
<a href="https://medium.com/metamask/eip712-is-coming-what-to-expect-and-how-to-use-it-bb92fd1a7a26" target="_blank" rel="noopener noreferrer">introductory blog post to this method</a>.</p><p>Hopefully soon we will also have good examples for parsing method input into structs for
verification on-chain.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/mm-docs-v2/staging/wallet/concepts/sdk-connections"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">MetaMask SDK connections</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/mm-docs-v2/staging/wallet/concepts/onboarding-library"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Onboarding library</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#history" class="table-of-contents__link toc-highlight">History</a><ul><li><a href="#signtypeddata_v1" class="table-of-contents__link toc-highlight"><code>signTypedData_v1</code></a></li><li><a href="#signtypeddata_v3" class="table-of-contents__link toc-highlight"><code>signTypedData_v3</code></a></li><li><a href="#signtypeddata_v4" class="table-of-contents__link toc-highlight"><code>signTypedData_v4</code></a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"></div></footer></div>
<script src="/mm-docs-v2/staging/assets/js/runtime~main.27521df3.js"></script>
<script src="/mm-docs-v2/staging/assets/js/main.6ed78e4d.js"></script>
</body>
</html>